import{r as j,j as e,J as l}from"./index-BbbxppCW.js";import{u as R}from"./index.esm-CYaOjpFt.js";import{o as H,s as f,t as J}from"./zod-BufzoQnV.js";import{b as q,c as O,d as $,e as z}from"./useTeachers-Bf63-l8L.js";import{B as g}from"./button-CIKh5vM4.js";import{C as n,b as d,a as m,c as b}from"./card-zbz7qCJr.js";import{S as u}from"./skeleton-TmsLY8PM.js";import{S as G}from"./switch-D6hUCL8N.js";import{F as K,a as y,b as N,c as _,d as w,f as v,e as F}from"./form-CqNglPU9.js";import{T as S}from"./textarea-BiZKJTtT.js";import{M as C}from"./MainLayout-BALAcp-P.js";import{u as Q}from"./useTranslation-CC21zoU6.js";import{U as I}from"./upload-C3ONQcIS.js";import{a as W,E as X}from"./eye-DpgY7ATH.js";import"./useQuery-BIga7gMY.js";import"./useMutation-C5-Yw93X.js";import"./index-wpz6Hu0Z.js";import"./label-Byme5i-Q.js";import"./useResponsiveLogo-oJ2RCBfb.js";import"./LanguageSwitcher-CFBw11ZH.js";import"./index-CNkEgW_D.js";import"./Combination-dIoxx1Zk.js";import"./index-CKCShlFX.js";import"./index-CrWK1cfR.js";import"./check-BhLxpiQA.js";import"./Logo-qwv8thKT.js";import"./user-CgQqfPiY.js";import"./log-out-CEU61esy.js";import"./users-8lpkJKwV.js";import"./book-open-SIfqpxXT.js";const Y=H({bio_en:f().optional(),bio_ar:f().optional(),bio_es:f().optional()}),Te=()=>{const{t:s}=Q(),{data:t,isLoading:D,isError:k,refetch:A}=q(),h=O(),x=$(),P=z(),[T,E]=j.useState(null),[p,U]=j.useState(null),o=R({resolver:J(Y),defaultValues:{bio_en:"",bio_ar:"",bio_es:""}});j.useEffect(()=>{var r,i,a;t&&(o.reset({bio_en:((r=t.bio)==null?void 0:r.en)||"",bio_ar:((i=t.bio)==null?void 0:i.ar)||"",bio_es:((a=t.bio)==null?void 0:a.es)||""}),t.profile_image_url&&E(t.profile_image_url))},[t,o]);const M=r=>{var a;const i=(a=r.target.files)==null?void 0:a[0];if(i){U(i);const c=new FileReader;c.onloadend=()=>{E(c.result)},c.readAsDataURL(i)}},V=async()=>{var r,i;if(p)try{const a=new FormData;a.append("profile_image",p),await x.mutateAsync(a),l.success(s("teacher.imageUploadedSuccess")),U(null)}catch(a){l.error(((i=(r=a.response)==null?void 0:r.data)==null?void 0:i.message)||s("teacher.imageUploadedError"))}},B=async()=>{var r,i;try{await P.mutateAsync(),l.success(s("teacher.visibilityUpdatedSuccess"))}catch(a){l.error(((i=(r=a.response)==null?void 0:r.data)==null?void 0:i.message)||s("teacher.visibilityUpdatedError"))}},L=async r=>{var i,a;try{const c={bio:{en:r.bio_en||"",ar:r.bio_ar||r.bio_en||"",es:r.bio_es||r.bio_en||""}};await h.mutateAsync(c),l.success(s("teacher.profileUpdatedSuccess"))}catch(c){l.error(((a=(i=c.response)==null?void 0:i.data)==null?void 0:a.message)||s("teacher.profileUpdatedError"))}};return D?e.jsx(C,{children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsx(u,{className:"h-10 w-48"}),e.jsxs(n,{children:[e.jsx(d,{children:e.jsx(u,{className:"h-6 w-32"})}),e.jsx(m,{className:"space-y-6",children:e.jsx(u,{className:"h-96 w-full"})})]})]})}):k||!t?e.jsx(C,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("p",{className:"text-red-600",children:s("teacher.errorLoadingProfile")}),e.jsx(g,{onClick:()=>A(),children:s("common.retry")})]})})}):e.jsx(C,{children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:s("teacher.profile")}),e.jsxs(n,{children:[e.jsx(d,{children:e.jsx(b,{children:s("teacher.profileImage")})}),e.jsx(m,{className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[e.jsx("div",{className:"flex-shrink-0",children:T?e.jsx("img",{src:T,alt:s("teacher.profileImage"),className:"w-32 h-32 rounded-full object-cover border-4 border-gray-200"}):e.jsx("div",{className:"w-32 h-32 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx(I,{className:"w-12 h-12 text-gray-400"})})}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"profile-image",className:"cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{children:s("teacher.chooseImage")})]}),e.jsx("input",{id:"profile-image",type:"file",accept:"image/*",onChange:M,className:"hidden"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s("teacher.imageRequirements")})]}),p&&e.jsx(g,{onClick:V,disabled:x.isPending,children:x.isPending?s("common.loading"):s("teacher.uploadImage")})]})]})})]}),e.jsxs(n,{children:[e.jsx(d,{children:e.jsx(b,{children:s("teacher.profileVisibility")})}),e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium",children:s("teacher.publicProfile")}),e.jsx("p",{className:"text-sm text-gray-600",children:t.is_visible?s("teacher.profileVisibleDescription"):s("teacher.profileHiddenDescription")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.is_visible?e.jsx(W,{className:"w-5 h-5 text-green-600"}):e.jsx(X,{className:"w-5 h-5 text-gray-400"}),e.jsx(G,{checked:t.is_visible,onCheckedChange:B,disabled:P.isPending})]})]})})]}),e.jsxs(n,{children:[e.jsx(d,{children:e.jsx(b,{children:s("teacher.bio")})}),e.jsx(m,{children:e.jsx(K,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(L),className:"space-y-6",children:[e.jsx(y,{control:o.control,name:"bio_en",render:({field:r})=>e.jsxs(N,{children:[e.jsx(_,{children:s("teacher.bioEnglish")}),e.jsx(w,{children:e.jsx(S,{placeholder:s("teacher.enterBioEnglish"),className:"min-h-32",...r})}),e.jsx(v,{children:s("teacher.bioDescription")}),e.jsx(F,{})]})}),e.jsx(y,{control:o.control,name:"bio_ar",render:({field:r})=>e.jsxs(N,{children:[e.jsx(_,{children:s("teacher.bioArabic")}),e.jsx(w,{children:e.jsx(S,{placeholder:s("teacher.enterBioArabic"),className:"min-h-32",...r,dir:"rtl"})}),e.jsx(v,{children:s("teacher.optionalField")}),e.jsx(F,{})]})}),e.jsx(y,{control:o.control,name:"bio_es",render:({field:r})=>e.jsxs(N,{children:[e.jsx(_,{children:s("teacher.bioSpanish")}),e.jsx(w,{children:e.jsx(S,{placeholder:s("teacher.enterBioSpanish"),className:"min-h-32",...r})}),e.jsx(v,{children:s("teacher.optionalField")}),e.jsx(F,{})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(g,{type:"submit",disabled:h.isPending,children:h.isPending?s("common.loading"):s("common.save")})})]})})})]})]})})};export{Te as TeacherProfile,Te as default};
