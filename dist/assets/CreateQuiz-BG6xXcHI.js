import{u as T,h as B,r as D,j as e,J as q}from"./index-BbbxppCW.js";import{u as E}from"./index.esm-CYaOjpFt.js";import{o as I,s as d,e as L,t as V}from"./zod-BufzoQnV.js";import{e as Q}from"./useQuizzes-Ce89MhCe.js";import{u as M}from"./useLanguages-joHChLWq.js";import{B as f}from"./button-CIKh5vM4.js";import{C as w,b as P,c as $,a as k}from"./card-zbz7qCJr.js";import{F as J,a as n,b as a,c,d as l,e as o,f as x}from"./form-CqNglPU9.js";import{I as p}from"./input-Dl5UbgYB.js";import{T as z}from"./textarea-BiZKJTtT.js";import{S,a as v,b as y,c as A,d as h}from"./select-Djc9bocP.js";import{M as H}from"./MainLayout-BALAcp-P.js";import{u as R}from"./useTranslation-CC21zoU6.js";import"./useQuery-BIga7gMY.js";import"./useMutation-C5-Yw93X.js";import"./useInfiniteQuery-B5ANnVOJ.js";import"./label-Byme5i-Q.js";import"./index-CNkEgW_D.js";import"./Combination-dIoxx1Zk.js";import"./index-CrWK1cfR.js";import"./index-wpz6Hu0Z.js";import"./check-BhLxpiQA.js";import"./useResponsiveLogo-oJ2RCBfb.js";import"./LanguageSwitcher-CFBw11ZH.js";import"./index-CKCShlFX.js";import"./Logo-qwv8thKT.js";import"./user-CgQqfPiY.js";import"./log-out-CEU61esy.js";import"./users-8lpkJKwV.js";import"./book-open-SIfqpxXT.js";const G=I({title_en:d().min(3,"Title must be at least 3 characters"),title_ar:d().optional(),title_es:d().optional(),description_en:d().min(10,"Description must be at least 10 characters"),description_ar:d().optional(),description_es:d().optional(),language_id:d().optional(),level:L(["A1","A2","B1","B2","C1","C2"]),duration_minutes:d().min(1,"Duration is required"),passing_score:d().min(1,"Passing score is required")}),qe=()=>{const{t:r}=R(),j=T(),{user:s}=B(),g=Q(),{data:_,isLoading:F}=M({is_active:1}),t=E({resolver:V(G),defaultValues:{title_en:"",title_ar:"",title_es:"",description_en:"",description_ar:"",description_es:"",language_id:"",level:"A1",duration_minutes:"30",passing_score:"70"}});D.useEffect(()=>{s!=null&&s.preferred_language_id&&t.setValue("language_id",s.preferred_language_id.toString())},[s,t]);const N=async i=>{var m,b;try{const u={title:{en:i.title_en,ar:i.title_ar||i.title_en,es:i.title_es||i.title_en},description:{en:i.description_en,ar:i.description_ar||i.description_en,es:i.description_es||i.description_en},level:i.level,duration_minutes:parseInt(i.duration_minutes),passing_score:parseInt(i.passing_score),is_active:!0};i.language_id&&(u.language_id=parseInt(i.language_id));const C=await g.mutateAsync(u);q.success(r("teacher.quizCreatedSuccess")),(s==null?void 0:s.role)==="admin"?j(`/teacher/quizzes/${C.id}/questions`):j(`/teacher/quizzes/${C.id}/questions`)}catch(u){q.error(((b=(m=u.response)==null?void 0:m.data)==null?void 0:b.message)||r("teacher.quizCreatedError"))}};return e.jsx(H,{children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:r("teacher.createQuiz")}),e.jsx(f,{variant:"outline",onClick:()=>j((s==null?void 0:s.role)==="admin"?"/admin/quizzes":"/teacher/quizzes"),children:r("common.cancel")})]}),e.jsxs(w,{children:[e.jsx(P,{children:e.jsx($,{children:r("teacher.quizDetails")})}),e.jsx(k,{children:e.jsx(J,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(N),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:r("quiz.title")}),e.jsx(n,{control:t.control,name:"title_en",render:({field:i})=>e.jsxs(a,{children:[e.jsx(c,{children:r("teacher.titleEnglish")}),e.jsx(l,{children:e.jsx(p,{placeholder:r("teacher.enterTitleEnglish"),...i})}),e.jsx(o,{})]})}),e.jsx(n,{control:t.control,name:"title_ar",render:({field:i})=>e.jsxs(a,{children:[e.jsx(c,{children:r("teacher.titleArabic")}),e.jsx(l,{children:e.jsx(p,{placeholder:r("teacher.enterTitleArabic"),...i,dir:"rtl"})}),e.jsx(x,{children:r("teacher.optionalField")}),e.jsx(o,{})]})}),e.jsx(n,{control:t.control,name:"title_es",render:({field:i})=>e.jsxs(a,{children:[e.jsx(c,{children:r("teacher.titleSpanish")}),e.jsx(l,{children:e.jsx(p,{placeholder:r("teacher.enterTitleSpanish"),...i})}),e.jsx(x,{children:r("teacher.optionalField")}),e.jsx(o,{})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:r("quiz.description")}),e.jsx(n,{control:t.control,name:"description_en",render:({field:i})=>e.jsxs(a,{children:[e.jsx(c,{children:r("teacher.descriptionEnglish")}),e.jsx(l,{children:e.jsx(z,{placeholder:r("teacher.enterDescriptionEnglish"),className:"min-h-24",...i})}),e.jsx(o,{})]})}),e.jsx(n,{control:t.control,name:"description_ar",render:({field:i})=>e.jsxs(a,{children:[e.jsx(c,{children:r("teacher.descriptionArabic")}),e.jsx(l,{children:e.jsx(z,{placeholder:r("teacher.enterDescriptionArabic"),className:"min-h-24",...i,dir:"rtl"})}),e.jsx(x,{children:r("teacher.optionalField")}),e.jsx(o,{})]})}),e.jsx(n,{control:t.control,name:"description_es",render:({field:i})=>e.jsxs(a,{children:[e.jsx(c,{children:r("teacher.descriptionSpanish")}),e.jsx(l,{children:e.jsx(z,{placeholder:r("teacher.enterDescriptionSpanish"),className:"min-h-24",...i})}),e.jsx(x,{children:r("teacher.optionalField")}),e.jsx(o,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(n,{control:t.control,name:"language_id",render:({field:i})=>e.jsxs(a,{children:[e.jsx(c,{children:r("quiz.language")}),e.jsxs(S,{onValueChange:i.onChange,value:i.value,children:[e.jsx(l,{children:e.jsx(v,{children:e.jsx(y,{placeholder:r("teacher.selectLanguage")})})}),e.jsx(A,{children:F?e.jsx(h,{value:"loading",disabled:!0,children:r("common.loading")}):_==null?void 0:_.map(m=>e.jsx(h,{value:m.id.toString(),children:m.name},m.id))})]}),e.jsx(x,{children:r("teacher.languageAutoFill")}),e.jsx(o,{})]})}),e.jsx(n,{control:t.control,name:"level",render:({field:i})=>e.jsxs(a,{children:[e.jsx(c,{children:r("quiz.level")}),e.jsxs(S,{onValueChange:i.onChange,defaultValue:i.value,children:[e.jsx(l,{children:e.jsx(v,{children:e.jsx(y,{placeholder:r("teacher.selectLevel")})})}),e.jsxs(A,{children:[e.jsx(h,{value:"A1",children:"A1"}),e.jsx(h,{value:"A2",children:"A2"}),e.jsx(h,{value:"B1",children:"B1"}),e.jsx(h,{value:"B2",children:"B2"}),e.jsx(h,{value:"C1",children:"C1"}),e.jsx(h,{value:"C2",children:"C2"})]})]}),e.jsx(o,{})]})}),e.jsx(n,{control:t.control,name:"duration_minutes",render:({field:i})=>e.jsxs(a,{children:[e.jsxs(c,{children:[r("quiz.duration")," (",r("quiz.minutes"),")"]}),e.jsx(l,{children:e.jsx(p,{type:"number",min:"1",...i})}),e.jsx(o,{})]})}),e.jsx(n,{control:t.control,name:"passing_score",render:({field:i})=>e.jsxs(a,{children:[e.jsxs(c,{children:[r("quiz.passingScore")," (%)"]}),e.jsx(l,{children:e.jsx(p,{type:"number",min:"0",max:"100",...i})}),e.jsx(o,{})]})})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(f,{type:"button",variant:"outline",onClick:()=>j((s==null?void 0:s.role)==="admin"?"/admin/quizzes":"/teacher/quizzes"),children:r("common.cancel")}),e.jsx(f,{type:"submit",disabled:g.isPending,children:g.isPending?r("common.loading"):r("teacher.createAndAddQuestions")})]})]})})})]})]})})};export{qe as CreateQuiz,qe as default};
