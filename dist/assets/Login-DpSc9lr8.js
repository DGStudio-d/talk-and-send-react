import{u as M,h as P,r as k,j as e,L as z,J as d}from"./index-BbbxppCW.js";import{u as B}from"./index.esm-CYaOjpFt.js";import{z as n,t as H}from"./zod-BufzoQnV.js";import{B as J}from"./button-CIKh5vM4.js";import{I as N}from"./input-Dl5UbgYB.js";import{L as v}from"./label-Byme5i-Q.js";import{C as W,b as D,c as O,e as R,a as $,d as q}from"./card-zbz7qCJr.js";import{L as G}from"./Logo-qwv8thKT.js";import{u as K}from"./useTranslation-CC21zoU6.js";import{L as Q}from"./loader-circle-BTqhVs_v.js";const U=n.object({email:n.string().email("validation.emailInvalid"),password:n.string().min(8,"validation.passwordMin")}),oe=()=>{const{t:s}=K(),t=M(),{login:L,isStudent:C,isTeacher:S,isAdmin:E}=P(),[r,m]=k.useState(!1),{register:c,handleSubmit:A,formState:{errors:a}}=B({resolver:H(U)}),F=async h=>{var p,u,x,f,g,j,b,y;m(!0);try{await L(h.email,h.password),d.success(s("auth.loginSuccess")),t(E?"/admin/dashboard":S?"/teacher/dashboard":C?"/student/dashboard":"/")}catch(i){if(console.error("Login error:",(p=i.response)==null?void 0:p.data),((u=i.response)==null?void 0:u.status)===422){const o=(f=(x=i.response)==null?void 0:x.data)==null?void 0:f.errors;o?Object.keys(o).forEach(I=>{const w=o[I];Array.isArray(w)&&w.forEach(l=>{const T=l.startsWith("auth.")||l.startsWith("validation.")?s(l):l;d.error(T)})}):d.error(((j=(g=i.response)==null?void 0:g.data)==null?void 0:j.message)||s("auth.loginError"))}else{const o=((y=(b=i.response)==null?void 0:b.data)==null?void 0:y.message)||s("auth.loginError");d.error(o)}}finally{m(!1)}};return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-primary-50 to-primary-100 p-4",children:[e.jsx("div",{className:"mb-8",children:e.jsx(G,{size:"lg"})}),e.jsxs(W,{className:"w-full max-w-md",children:[e.jsxs(D,{className:"space-y-1",children:[e.jsx(O,{id:"login-title",className:"text-2xl font-bold text-center",children:s("auth.loginTitle")}),e.jsx(R,{className:"text-center",children:s("auth.emailPlaceholder")})]}),e.jsx($,{children:e.jsxs("form",{onSubmit:A(F),className:"space-y-4","aria-labelledby":"login-title",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"email",children:s("common.email")}),e.jsx(N,{id:"email",type:"email",placeholder:s("auth.emailPlaceholder"),...c("email"),disabled:r,className:a.email?"border-red-500":"","aria-invalid":!!a.email,"aria-describedby":a.email?"email-error":void 0}),a.email&&e.jsx("p",{id:"email-error",className:"text-sm text-red-500",role:"alert",children:s(a.email.message)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"password",children:s("common.password")}),e.jsx(N,{id:"password",type:"password",placeholder:s("auth.passwordPlaceholder"),...c("password"),disabled:r,className:a.password?"border-red-500":"","aria-invalid":!!a.password,"aria-describedby":a.password?"password-error":void 0}),a.password&&e.jsx("p",{id:"password-error",className:"text-sm text-red-500",role:"alert",children:s(a.password.message)})]}),e.jsx(J,{type:"submit",className:"w-full",disabled:r,"aria-busy":r,children:r?e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"mr-2 h-4 w-4 animate-spin","aria-hidden":"true"}),s("common.loading")]}):s("common.login")})]})}),e.jsx(q,{className:"flex justify-center",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s("auth.dontHaveAccount")," ",e.jsx(z,{to:"/register",className:"text-primary hover:underline font-medium",children:s("common.register")})]})})]})]})};export{oe as Login,oe as default};
