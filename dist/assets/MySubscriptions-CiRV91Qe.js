import{u as k,r as N,j as s,J as C}from"./index-BbbxppCW.js";import{c as P,d as B}from"./useSubscriptions-CXEXM7mV.js";import{M}from"./MainLayout-BALAcp-P.js";import{C as m,b as v,a as h,c as $,e as H}from"./card-zbz7qCJr.js";import{B as p}from"./button-CIKh5vM4.js";import{T as L,a as R,b as y,c as i,d as E,e as n}from"./table-D7A3MFyr.js";import{S as _}from"./skeleton-TmsLY8PM.js";import{B as z}from"./badge-B57fkYpB.js";import{A as J,a as U,b as F,c as O,d as X,e as q,f as G,g as I}from"./alert-dialog-BMVIkOSi.js";import{a as K}from"./translationHelpers-BzGVKULz.js";import{u as Q}from"./useTranslation-CC21zoU6.js";import{C as D}from"./circle-x-CAdb3oZW.js";import{C as V}from"./calendar-BGtI_0eA.js";import{C as W}from"./clock-BfSKEJpp.js";import{U as Y}from"./users-8lpkJKwV.js";import"./useQuery-BIga7gMY.js";import"./useMutation-C5-Yw93X.js";import"./useResponsiveLogo-oJ2RCBfb.js";import"./LanguageSwitcher-CFBw11ZH.js";import"./index-CNkEgW_D.js";import"./Combination-dIoxx1Zk.js";import"./index-CKCShlFX.js";import"./index-CrWK1cfR.js";import"./check-BhLxpiQA.js";import"./Logo-qwv8thKT.js";import"./user-CgQqfPiY.js";import"./log-out-CEU61esy.js";import"./book-open-SIfqpxXT.js";import"./index-BtDOLYso.js";const As=()=>{const{t:a,i18n:j}=Q(),g=k(),[l,S]=N.useState(null),[w,x]=N.useState(!1),{data:o,isLoading:A}=P(),c=B(),f=e=>{S(e),x(!0)},T=async()=>{var e,t;if(l)try{await c.mutateAsync(l.id),C.success(a("subscription.cancelSuccess")),x(!1)}catch(r){C.error(((t=(e=r.response)==null?void 0:e.data)==null?void 0:t.message)||a("subscription.cancelError"))}},b=e=>{const t={active:"default",pending:"secondary",expired:"outline",cancelled:"destructive"};return s.jsx(z,{variant:t[e]||"outline",children:a(`subscription.status.${e}`)})},d=e=>new Date(e).toLocaleDateString(j.language,{year:"numeric",month:"long",day:"numeric"}),u=e=>{const t=e.subscription_plan;if(!t)return"";const r=K(t.language,j.language);return`${a(`subscription.${t.type}`)} - ${r}`};return s.jsxs(M,{children:[s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:a("subscription.mySubscriptions")}),s.jsx("p",{className:"text-muted-foreground mt-2",children:a("subscription.mySubscriptionsDescription")})]}),s.jsx(p,{onClick:()=>g("/subscriptions/plans"),children:a("subscription.browsePlans")})]}),A?s.jsxs(m,{children:[s.jsx(v,{children:s.jsx(_,{className:"h-6 w-1/3"})}),s.jsx(h,{children:s.jsx("div",{className:"space-y-4",children:[1,2,3].map(e=>s.jsx(_,{className:"h-20 w-full"},e))})})]}):o&&o.length>0?s.jsxs("div",{className:"space-y-6",children:[s.jsx(m,{className:"hidden md:block",children:s.jsxs(L,{children:[s.jsx(R,{children:s.jsxs(y,{children:[s.jsx(i,{children:a("subscription.plan")}),s.jsx(i,{children:a("subscription.type")}),s.jsx(i,{children:a("subscription.status")}),s.jsx(i,{children:a("subscription.startDate")}),s.jsx(i,{children:a("subscription.endDate")}),s.jsx(i,{children:a("subscription.sessionsRemaining")}),s.jsx(i,{className:"text-right",children:a("common.actions")})]})}),s.jsx(E,{children:o.map(e=>{var t;return s.jsxs(y,{children:[s.jsx(n,{className:"font-medium",children:u(e)}),s.jsx(n,{children:e.subscription_plan?a(`subscription.${e.subscription_plan.type}`):""}),s.jsx(n,{children:b(e.status)}),s.jsx(n,{children:e.start_date?d(e.start_date):"-"}),s.jsx(n,{children:e.end_date?d(e.end_date):"-"}),s.jsxs(n,{children:[e.sessions_remaining," / ",(t=e.subscription_plan)==null?void 0:t.sessions_per_month]}),s.jsx(n,{className:"text-right",children:e.status==="active"&&s.jsxs(p,{variant:"destructive",size:"sm",onClick:()=>f(e),disabled:c.isPending,children:[s.jsx(D,{className:"h-4 w-4 mr-2"}),a("subscription.cancel")]})})]},e.id)})})]})}),s.jsx("div",{className:"md:hidden space-y-4",children:o.map(e=>{var t,r;return s.jsxs(m,{children:[s.jsxs(v,{children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsx($,{className:"text-lg",children:u(e)}),b(e.status)]}),s.jsx(H,{children:e.subscription_plan?a(`subscription.${e.subscription_plan.type}`):""})]}),s.jsxs(h,{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(V,{className:"h-4 w-4 text-muted-foreground"}),s.jsxs("span",{children:[e.start_date?d(e.start_date):"-"," - ",e.end_date?d(e.end_date):"-"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(W,{className:"h-4 w-4 text-muted-foreground"}),s.jsxs("span",{children:[e.sessions_remaining," / ",(t=e.subscription_plan)==null?void 0:t.sessions_per_month," ",a("subscription.sessionsRemaining")]})]}),((r=e.subscription_plan)==null?void 0:r.type)==="group"&&e.group_subscription&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Y,{className:"h-4 w-4 text-muted-foreground"}),s.jsxs("span",{children:[a("subscription.group"),": ",e.group_subscription.group_name]})]}),e.status==="active"&&s.jsxs(p,{variant:"destructive",size:"sm",className:"w-full mt-4",onClick:()=>f(e),disabled:c.isPending,children:[s.jsx(D,{className:"h-4 w-4 mr-2"}),a("subscription.cancel")]})]})]},e.id)})})]}):s.jsx(m,{children:s.jsxs(h,{className:"py-12 text-center space-y-4",children:[s.jsx("p",{className:"text-muted-foreground",children:a("subscription.noSubscriptions")}),s.jsx(p,{onClick:()=>g("/subscriptions/plans"),children:a("subscription.browsePlans")})]})})]}),s.jsx(J,{open:w,onOpenChange:x,children:s.jsxs(U,{children:[s.jsxs(F,{children:[s.jsx(O,{children:a("subscription.cancelSubscription")}),s.jsx(X,{children:l&&s.jsxs("div",{className:"space-y-2 mt-4",children:[s.jsx("p",{children:a("subscription.cancelConfirmMessage")}),s.jsx("p",{className:"font-medium",children:u(l)})]})})]}),s.jsxs(q,{children:[s.jsx(G,{children:a("common.cancel")}),s.jsx(I,{onClick:T,disabled:c.isPending,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:c.isPending?a("common.loading"):a("subscription.confirmCancel")})]})]})})]})};export{As as default};
