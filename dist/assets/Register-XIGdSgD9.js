import{U as m,u as G,h as K,r as b,j as e,L as Q,J as N,s as Y}from"./index-BbbxppCW.js";import{u as Z}from"./index.esm-CYaOjpFt.js";import{z as i,t as O}from"./zod-BufzoQnV.js";import{u as X}from"./useQuery-BIga7gMY.js";import{u as ee}from"./useLanguages-joHChLWq.js";import{B as S}from"./button-CIKh5vM4.js";import{I as h}from"./input-Dl5UbgYB.js";import{L as l}from"./label-Byme5i-Q.js";import{S as L,a as A,b as I,c as T,d as x}from"./select-Djc9bocP.js";import{C as k,b as F,c as z,e as B,a as D}from"./card-zbz7qCJr.js";import{T as se,a as ae,b as U,c as R}from"./tabs-DbT1-NYe.js";import{A as v,a as y}from"./alert-Ckbomrq-.js";import{L as re}from"./Logo-qwv8thKT.js";import{u as te}from"./useTranslation-CC21zoU6.js";import{C as ie}from"./credit-card-vHHxPXcT.js";import{C as H}from"./circle-alert-BdtuzKfq.js";import{U as ne}from"./user-CgQqfPiY.js";import{U as le}from"./users-8lpkJKwV.js";import{C as V}from"./check-BhLxpiQA.js";import{L as de}from"./loader-circle-BTqhVs_v.js";import"./useMutation-C5-Yw93X.js";import"./index-CNkEgW_D.js";import"./Combination-dIoxx1Zk.js";import"./index-CrWK1cfR.js";import"./index-wpz6Hu0Z.js";import"./index-CKCShlFX.js";const ce=i.object({name:i.string().min(2,"Name must be at least 2 characters"),email:i.string().email("Invalid email address"),phone:i.string().regex(/^\+?[1-9]\d{1,14}$/,"Invalid phone number format"),password:i.string().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Password must contain at least one uppercase letter").regex(/[a-z]/,"Password must contain at least one lowercase letter").regex(/[0-9]/,"Password must contain at least one number"),password_confirmation:i.string(),preferred_language_id:i.string().min(1,"Please select a preferred language"),level:i.enum([m.Beginner,m.Intermediate,m.Advanced],{message:"Please select a level"}),subscription_plan_id:i.string().min(1,"Please select a subscription plan")}).refine(s=>s.password===s.password_confirmation,{message:"Passwords don't match",path:["password_confirmation"]}),De=()=>{const{t:s}=te(),E=G(),{register:M}=K(),{data:g,isLoading:w}=ee({is_active:!0}),[t,_]=b.useState(!1),[d,W]=b.useState(""),[u,P]=b.useState(""),{data:n}=X({queryKey:["subscriptionPlans",d],queryFn:async()=>d?(await Y.getPlansByLanguage(parseInt(d))).data.data:[],enabled:!!d}),j=n==null?void 0:n.find(a=>a.id===parseInt(u)),{register:c,handleSubmit:$,setValue:C,formState:{errors:r}}=Z({resolver:O(ce)}),q=async a=>{var o,p;_(!0);try{const f={...a,preferred_language_id:parseInt(a.preferred_language_id)};await M(f),N.success(s("auth.registrationPending")||"Registration successful! Your account will be activated after payment confirmation. Please transfer the fee and confirm via WhatsApp.",{duration:8e3}),E("/login")}catch(f){const J=((p=(o=f.response)==null?void 0:o.data)==null?void 0:p.message)||s("auth.registerError")||"Registration failed. Please try again.";N.error(J)}finally{_(!1)}};return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-primary-50 to-primary-100 p-4",children:[e.jsx("div",{className:"mb-8",children:e.jsx(re,{size:"lg"})}),e.jsxs(k,{className:"w-full max-w-2xl",children:[e.jsxs(F,{className:"space-y-1",children:[e.jsx(z,{className:"text-2xl font-bold text-center",children:s("auth.createAccount")||"Create your account"}),e.jsxs(B,{className:"text-center",children:[s("auth.haveAccount")||"Already have an account?"," ",e.jsx(Q,{to:"/login",className:"text-primary hover:underline font-medium",children:s("auth.signIn")||"Sign in here"})]})]}),e.jsx(D,{children:e.jsxs(se,{defaultValue:"register",className:"w-full",children:[e.jsxs(ae,{className:"grid w-full grid-cols-2",children:[e.jsx(U,{value:"register",children:s("auth.registrationForm")||"Registration Form"}),e.jsx(U,{value:"payment",children:s("auth.paymentInfo")||"Payment Info"})]}),e.jsx(R,{value:"payment",className:"space-y-4 mt-4",children:e.jsxs(k,{children:[e.jsx(F,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(ie,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx(z,{className:"text-lg",children:s("auth.bankTransferDetails")||"Bank Transfer Details"}),e.jsx(B,{children:s("auth.useTheseDetails")||"Use these details to make your payment"})]})]})}),e.jsxs(D,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-3 bg-muted rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:[s("auth.bankName")||"Bank Name",":"]}),e.jsx("span",{className:"text-sm font-semibold",children:"Attijariwafa Bank"})]}),e.jsxs("div",{className:"flex justify-between items-start py-2 border-b",children:[e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:[s("auth.accountNumber")||"Account Number",":"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-mono font-semibold",children:"007 640 000 123 456 789 012"}),e.jsx(S,{type:"button",variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText("007640000123456789012"),N.success(s("auth.copiedToClipboard")||"Copied to clipboard!")},className:"ml-2 h-6 text-xs",children:s("auth.copy")||"Copy"})]})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:[s("auth.accountHolder")||"Account Holder",":"]}),e.jsx("span",{className:"text-sm font-semibold",children:"Language Learning Center"})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:[s("auth.whatsapp")||"WhatsApp",":"]}),e.jsxs("a",{href:"https://wa.me/212625815692",target:"_blank",rel:"noopener noreferrer",className:"text-sm font-semibold text-primary hover:underline flex items-center gap-1",children:["+212 625-815692",e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})})]})]})]}),e.jsxs(v,{children:[e.jsx(H,{className:"h-4 w-4"}),e.jsxs(y,{children:[e.jsx("h4",{className:"font-medium mb-2",children:s("auth.importantSteps")||"Important Steps"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm",children:[e.jsx("li",{children:s("auth.step1")||"Complete the registration form"}),e.jsx("li",{children:s("auth.step2")||"Transfer the subscription fee to the bank account"}),e.jsx("li",{children:s("auth.step3")||"Send payment confirmation via WhatsApp with your name and email"}),e.jsx("li",{children:s("auth.step4")||"Wait for admin to activate your account (usually within 24 hours)"})]})]})]})]})]})}),e.jsx(R,{value:"register",className:"space-y-4 mt-4",children:e.jsxs("form",{onSubmit:$(q),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"name",children:s("auth.name")||"Full Name"}),e.jsx(h,{id:"name",type:"text",placeholder:s("auth.namePlaceholder"),...c("name"),disabled:t,className:r.name?"border-red-500":""}),r.name&&e.jsx("p",{className:"text-sm text-red-500",children:r.name.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"email",children:s("auth.email")||"Email address"}),e.jsx(h,{id:"email",type:"email",placeholder:s("auth.emailPlaceholder"),...c("email"),disabled:t,className:r.email?"border-red-500":""}),r.email&&e.jsx("p",{className:"text-sm text-red-500",children:r.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"phone",children:s("auth.phone")||"Phone Number"}),e.jsx(h,{id:"phone",type:"tel",placeholder:"+1234567890",...c("phone"),disabled:t,className:r.phone?"border-red-500":""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Format: +1234567890"}),r.phone&&e.jsx("p",{className:"text-sm text-red-500",children:r.phone.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"password",children:s("auth.password")||"Password"}),e.jsx(h,{id:"password",type:"password",placeholder:s("auth.passwordPlaceholder"),...c("password"),disabled:t,className:r.password?"border-red-500":""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"At least 8 characters with uppercase, lowercase, and number"}),r.password&&e.jsx("p",{className:"text-sm text-red-500",children:r.password.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"password_confirmation",children:s("auth.confirmPassword")||"Confirm Password"}),e.jsx(h,{id:"password_confirmation",type:"password",placeholder:s("auth.passwordPlaceholder"),...c("password_confirmation"),disabled:t,className:r.password_confirmation?"border-red-500":""}),r.password_confirmation&&e.jsx("p",{className:"text-sm text-red-500",children:r.password_confirmation.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"preferred_language_id",children:s("auth.preferredLanguage")||"Preferred Language"}),e.jsxs(L,{onValueChange:a=>{C("preferred_language_id",a),W(a),P("")},disabled:t||w,children:[e.jsx(A,{id:"preferred_language_id",className:r.preferred_language_id?"border-red-500":"",children:e.jsx(I,{placeholder:s("auth.selectLanguage")||"Select a language"})}),e.jsx(T,{children:g==null?void 0:g.map(a=>e.jsx(x,{value:a.id.toString(),children:a.localized_name||a.name},a.id))})]}),r.preferred_language_id&&e.jsx("p",{className:"text-sm text-red-500",children:r.preferred_language_id.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"level",children:s("auth.level")||"Level"}),e.jsxs(L,{onValueChange:a=>C("level",a),disabled:t,children:[e.jsx(A,{id:"level",className:r.level?"border-red-500":"",children:e.jsx(I,{placeholder:s("auth.selectLevel")||"Select your level"})}),e.jsxs(T,{children:[e.jsx(x,{value:m.Beginner,children:s("level.beginner")||"Beginner"}),e.jsx(x,{value:m.Intermediate,children:s("level.intermediate")||"Intermediate"}),e.jsx(x,{value:m.Advanced,children:s("level.advanced")||"Advanced"})]})]}),r.level&&e.jsx("p",{className:"text-sm text-red-500",children:r.level.message})]}),d&&n&&n.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(l,{children:[s("auth.selectSubscriptionPlan")||"Select Subscription Plan"," *"]}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:n.map(a=>e.jsxs("label",{className:`relative flex cursor-pointer rounded-lg border p-4 transition-all ${u===a.id.toString()?"border-primary bg-primary/5 ring-2 ring-primary":"border-border hover:border-primary/50"}`,children:[e.jsx("input",{type:"radio",value:a.id,...c("subscription_plan_id"),onChange:o=>P(o.target.value),className:"sr-only"}),e.jsxs("div",{className:"flex flex-1 items-center gap-3",children:[e.jsx("div",{className:`flex-shrink-0 ${u===a.id.toString()?"text-primary":"text-muted-foreground"}`,children:a.type==="individual"?e.jsx(ne,{size:24}):e.jsx(le,{size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold",children:a.type==="individual"?s("subscription.individual")||"Individual (1-on-1)":s("subscription.group")||"Group Learning"}),e.jsxs("span",{className:"text-lg font-bold text-primary",children:[a.price," DH"]})]}),e.jsxs("div",{className:"mt-1 text-sm text-muted-foreground",children:[a.sessions_per_month," ",s("subscription.sessions")||"sessions"," Ã— ",a.session_duration_minutes," ",s("subscription.minutes")||"min",a.type==="group"&&a.max_group_members&&e.jsxs("span",{className:"ml-2",children:["(",s("subscription.maxMembers")||"Max",": ",a.max_group_members,")"]})]}),a.features&&Array.isArray(a.features)&&a.features.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:a.features.slice(0,2).map((o,p)=>e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(V,{size:12,className:"text-primary"}),e.jsx("span",{children:o})]},p))})]}),u===a.id.toString()&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-6 h-6 bg-primary rounded-full flex items-center justify-center",children:e.jsx(V,{size:16,className:"text-primary-foreground"})})})]})]},a.id))}),r.subscription_plan_id&&e.jsx("p",{className:"text-sm text-red-500",children:r.subscription_plan_id.message})]}),d&&(!n||n.length===0)&&e.jsxs(v,{children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx(y,{children:s("auth.noPlansAvailable")||"No subscription plans available for this language yet."})]}),j&&e.jsx(v,{children:e.jsxs(y,{children:[e.jsx("h4",{className:"font-semibold mb-2",children:s("auth.selectedPlan")||"Selected Plan"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[s("auth.amount")||"Amount",":"]})," ",j.price," DH/month"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[s("auth.type")||"Type",":"]})," ",j.type==="individual"?s("subscription.individual"):s("subscription.group")]}),e.jsx("p",{className:"text-xs mt-2 text-muted-foreground",children:s("auth.transferThisAmount")||"Please transfer this amount to the bank account shown in the Payment Info tab."})]})]})}),e.jsx(S,{type:"submit",className:"w-full",disabled:t||w,children:t?e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"mr-2 h-4 w-4 animate-spin"}),s("common.loading")]}):s("auth.register")||"Register"})]})})]})})]})]})};export{De as Register,De as default};
