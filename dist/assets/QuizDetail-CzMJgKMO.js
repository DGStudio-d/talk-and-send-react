import{d as S,u as T,a as A,j as e,J as B}from"./index-BbbxppCW.js";import{C as t,b as u,a as n,c as v}from"./card-zbz7qCJr.js";import{B as c}from"./button-CIKh5vM4.js";import{B as z}from"./badge-B57fkYpB.js";import{S as o}from"./skeleton-TmsLY8PM.js";import{a as D}from"./useQuizzes-Ce89MhCe.js";import{u as I}from"./useQuizAttempts-BC2VXcJH.js";import{M as h}from"./MainLayout-BALAcp-P.js";import{u as L}from"./useTranslation-CC21zoU6.js";import{C as b}from"./circle-alert-BdtuzKfq.js";import{F}from"./file-question-DCxyUbKp.js";import{C as M}from"./clock-BfSKEJpp.js";import{T as P}from"./target-Dx8SBibj.js";import{U as $}from"./user-CgQqfPiY.js";import{C as E}from"./circle-check-Dsibk6Jb.js";import{C as J}from"./circle-x-CAdb3oZW.js";import"./useQuery-BIga7gMY.js";import"./useMutation-C5-Yw93X.js";import"./useInfiniteQuery-B5ANnVOJ.js";import"./useResponsiveLogo-oJ2RCBfb.js";import"./LanguageSwitcher-CFBw11ZH.js";import"./index-CNkEgW_D.js";import"./Combination-dIoxx1Zk.js";import"./index-CKCShlFX.js";import"./index-CrWK1cfR.js";import"./check-BhLxpiQA.js";import"./Logo-qwv8thKT.js";import"./log-out-CEU61esy.js";import"./users-8lpkJKwV.js";import"./book-open-SIfqpxXT.js";const fe=()=>{var g,N,f,y;const{id:q}=S(),i=T(),{t:a}=L(),{locale:m}=A(),d=parseInt(q||"0"),{data:s,isLoading:w,isError:_}=D(d),x=I(),C=async()=>{var r,l;try{const p=await x.mutateAsync(d);i(`/quizzes/${d}/take/${p.id}`)}catch(p){B.error(((l=(r=p.response)==null?void 0:r.data)==null?void 0:l.message)||a("quiz.errorStartingQuiz"))}};if(w)return e.jsx(h,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(c,{variant:"outline",onClick:()=>i("/quizzes"),children:a("common.back")}),e.jsxs(t,{children:[e.jsxs(u,{children:[e.jsx(o,{className:"h-8 w-3/4 mb-2"}),e.jsx(o,{className:"h-4 w-1/2"})]}),e.jsxs(n,{className:"space-y-4",children:[e.jsx(o,{className:"h-20 w-full"}),e.jsx(o,{className:"h-10 w-32"})]})]})]})});if(_||!s)return e.jsx(h,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(c,{variant:"outline",onClick:()=>i("/quizzes"),children:a("common.back")}),e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(b,{className:"w-16 h-16 mx-auto text-red-500"}),e.jsx("p",{className:"text-red-600",children:a("quiz.errorLoadingQuiz")}),e.jsx(c,{onClick:()=>i("/quizzes"),children:a("quiz.backToQuizzes")})]})})]})});const k=s.title[m]||s.title.en,j=((g=s.description)==null?void 0:g[m])||((N=s.description)==null?void 0:N.en),Q=r=>{const l=new Date(r);return new Intl.DateTimeFormat(m,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(l)};return e.jsx(h,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(c,{variant:"outline",onClick:()=>i("/quizzes"),children:a("common.back")}),!s.is_active&&e.jsx(t,{className:"border-yellow-500 bg-yellow-50",children:e.jsxs(n,{className:"flex items-center gap-3 p-4",children:[e.jsx(b,{className:"w-5 h-5 text-yellow-600"}),e.jsx("p",{className:"text-yellow-800",children:a("quiz.quizInactive")})]})}),e.jsxs(t,{children:[e.jsx(u,{children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx(v,{className:"text-3xl mb-2",children:k}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[((f=s.language)==null?void 0:f.flag_url)&&e.jsx("img",{src:s.language.flag_url,alt:s.language.code,className:"w-8 h-6 object-cover rounded"}),e.jsx(z,{className:"bg-primary-500 hover:bg-primary-600",children:s.level})]})]})})}),e.jsxs(n,{className:"space-y-6",children:[j&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:a("quiz.description")}),e.jsx("p",{className:"text-gray-700",children:j})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg",children:[e.jsx(F,{className:"w-5 h-5 text-primary-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:a("quiz.questions")}),e.jsx("p",{className:"font-semibold",children:s.questions_count||0})]})]}),s.duration_minutes&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg",children:[e.jsx(M,{className:"w-5 h-5 text-primary-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:a("quiz.duration")}),e.jsxs("p",{className:"font-semibold",children:[s.duration_minutes," ",a("quiz.minutes")]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg",children:[e.jsx(P,{className:"w-5 h-5 text-primary-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:a("quiz.passingScore")}),e.jsxs("p",{className:"font-semibold",children:[s.passing_score,"%"]})]})]}),s.creator&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg",children:[e.jsx($,{className:"w-5 h-5 text-primary-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:a("quiz.teacher")}),e.jsx("p",{className:"font-semibold",children:s.creator.name})]})]})]}),((y=s.creator)==null?void 0:y.teacher_profile)&&e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[s.creator.teacher_profile.profile_image_url&&e.jsx("img",{src:s.creator.teacher_profile.profile_image_url,alt:s.creator.name,className:"w-16 h-16 rounded-full object-cover"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s.creator.name}),e.jsx("p",{className:"text-sm text-gray-600",children:a("quiz.createdBy")})]})]}),e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx(c,{size:"lg",onClick:C,disabled:!s.is_active||x.isPending,className:"bg-primary-500 hover:bg-primary-600 text-black",children:x.isPending?a("quiz.starting"):a("quiz.startQuiz")})})]})]}),s.attempts&&s.attempts.length>0&&e.jsxs(t,{children:[e.jsx(u,{children:e.jsx(v,{children:a("quiz.previousAttempts")})}),e.jsx(n,{children:e.jsx("div",{className:"space-y-3",children:s.attempts.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>i(`/attempts/${r.id}/results`),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[r.is_passed?e.jsx(E,{className:"w-6 h-6 text-green-500"}):e.jsx(J,{className:"w-6 h-6 text-red-500"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold",children:[r.correct_answers,"/",r.total_questions," (",r.percentage,"%)"]}),e.jsx("p",{className:"text-sm text-gray-600",children:Q(r.completed_at||r.started_at)})]})]}),e.jsx(z,{variant:r.is_passed?"default":"destructive",children:r.is_passed?a("quiz.passed"):a("quiz.failed")})]},r.id))})})]})]})})};export{fe as QuizDetail,fe as default};
