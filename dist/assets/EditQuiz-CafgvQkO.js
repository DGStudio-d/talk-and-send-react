import{d as U,u as J,r as $,j as e,J as E}from"./index-BbbxppCW.js";import{u as H}from"./index.esm-CYaOjpFt.js";import{o as R,s as m,e as G,t as K}from"./zod-BufzoQnV.js";import{a as O,f as W}from"./useQuizzes-Ce89MhCe.js";import{u as X}from"./useLanguages-joHChLWq.js";import{B as g}from"./button-CIKh5vM4.js";import{C as v,b as L,a as D,c as Y}from"./card-zbz7qCJr.js";import{S as q}from"./skeleton-TmsLY8PM.js";import{F as Z,a,b as c,c as l,d as o,e as d,f as _}from"./form-CqNglPU9.js";import{I as p}from"./input-Dl5UbgYB.js";import{T as N}from"./textarea-BiZKJTtT.js";import{S as w,a as A,b as B,c as Q,d as j}from"./select-Djc9bocP.js";import{M as S}from"./MainLayout-BALAcp-P.js";import{u as ee}from"./useTranslation-CC21zoU6.js";import"./useQuery-BIga7gMY.js";import"./useMutation-C5-Yw93X.js";import"./useInfiniteQuery-B5ANnVOJ.js";import"./label-Byme5i-Q.js";import"./index-CNkEgW_D.js";import"./Combination-dIoxx1Zk.js";import"./index-CrWK1cfR.js";import"./index-wpz6Hu0Z.js";import"./check-BhLxpiQA.js";import"./useResponsiveLogo-oJ2RCBfb.js";import"./LanguageSwitcher-CFBw11ZH.js";import"./index-CKCShlFX.js";import"./Logo-qwv8thKT.js";import"./user-CgQqfPiY.js";import"./log-out-CEU61esy.js";import"./users-8lpkJKwV.js";import"./book-open-SIfqpxXT.js";const se=R({title_en:m().min(3,"Title must be at least 3 characters"),title_ar:m().optional(),title_es:m().optional(),description_en:m().min(10,"Description must be at least 10 characters"),description_ar:m().optional(),description_es:m().optional(),language_id:m().min(1,"Please select a language"),level:G(["Beginner","Intermediate","Advanced"]),duration_minutes:m().min(1,"Duration is required"),passing_score:m().min(1,"Passing score is required")}),De=()=>{const{id:k}=U(),{t:s}=ee(),u=J(),f=parseInt(k||"0"),{data:n,isLoading:P}=O(f),z=W(),{data:b,isLoading:M}=X({is_active:1}),r=H({resolver:K(se),defaultValues:{title_en:"",title_ar:"",title_es:"",description_en:"",description_ar:"",description_es:"",language_id:"",level:"Beginner",duration_minutes:"30",passing_score:"70"}});$.useEffect(()=>{var i,t,h,x,y,F,C,T,I;n&&r.reset({title_en:((i=n.title)==null?void 0:i.en)||"",title_ar:((t=n.title)==null?void 0:t.ar)||"",title_es:((h=n.title)==null?void 0:h.es)||"",description_en:((x=n.description)==null?void 0:x.en)||"",description_ar:((y=n.description)==null?void 0:y.ar)||"",description_es:((F=n.description)==null?void 0:F.es)||"",language_id:((C=n.language_id)==null?void 0:C.toString())||"",level:n.level||"Beginner",duration_minutes:((T=n.duration_minutes)==null?void 0:T.toString())||"30",passing_score:((I=n.passing_score)==null?void 0:I.toString())||"70"})},[n,r]);const V=async i=>{var t,h;try{const x={title:{en:i.title_en,ar:i.title_ar||i.title_en,es:i.title_es||i.title_en},description:{en:i.description_en,ar:i.description_ar||i.description_en,es:i.description_es||i.description_en},language_id:parseInt(i.language_id),level:i.level,duration_minutes:parseInt(i.duration_minutes),passing_score:parseInt(i.passing_score)};await z.mutateAsync({id:f,data:x}),E.success(s("teacher.quizUpdatedSuccess")),u(`/teacher/quizzes/${f}/questions`)}catch(x){E.error(((h=(t=x.response)==null?void 0:t.data)==null?void 0:h.message)||s("teacher.quizUpdatedError"))}};return P?e.jsx(S,{children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsx(q,{className:"h-10 w-48"}),e.jsxs(v,{children:[e.jsx(L,{children:e.jsx(q,{className:"h-6 w-32"})}),e.jsx(D,{className:"space-y-6",children:e.jsx(q,{className:"h-96 w-full"})})]})]})}):n?e.jsx(S,{children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:s("teacher.editQuiz")}),e.jsx(g,{variant:"outline",onClick:()=>u("/teacher/quizzes"),children:s("common.cancel")})]}),e.jsxs(v,{children:[e.jsx(L,{children:e.jsx(Y,{children:s("teacher.quizDetails")})}),e.jsx(D,{children:e.jsx(Z,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(V),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:s("quiz.title")}),e.jsx(a,{control:r.control,name:"title_en",render:({field:i})=>e.jsxs(c,{children:[e.jsx(l,{children:s("teacher.titleEnglish")}),e.jsx(o,{children:e.jsx(p,{placeholder:s("teacher.enterTitleEnglish"),...i})}),e.jsx(d,{})]})}),e.jsx(a,{control:r.control,name:"title_ar",render:({field:i})=>e.jsxs(c,{children:[e.jsx(l,{children:s("teacher.titleArabic")}),e.jsx(o,{children:e.jsx(p,{placeholder:s("teacher.enterTitleArabic"),...i,dir:"rtl"})}),e.jsx(_,{children:s("teacher.optionalField")}),e.jsx(d,{})]})}),e.jsx(a,{control:r.control,name:"title_es",render:({field:i})=>e.jsxs(c,{children:[e.jsx(l,{children:s("teacher.titleSpanish")}),e.jsx(o,{children:e.jsx(p,{placeholder:s("teacher.enterTitleSpanish"),...i})}),e.jsx(_,{children:s("teacher.optionalField")}),e.jsx(d,{})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:s("quiz.description")}),e.jsx(a,{control:r.control,name:"description_en",render:({field:i})=>e.jsxs(c,{children:[e.jsx(l,{children:s("teacher.descriptionEnglish")}),e.jsx(o,{children:e.jsx(N,{placeholder:s("teacher.enterDescriptionEnglish"),className:"min-h-24",...i})}),e.jsx(d,{})]})}),e.jsx(a,{control:r.control,name:"description_ar",render:({field:i})=>e.jsxs(c,{children:[e.jsx(l,{children:s("teacher.descriptionArabic")}),e.jsx(o,{children:e.jsx(N,{placeholder:s("teacher.enterDescriptionArabic"),className:"min-h-24",...i,dir:"rtl"})}),e.jsx(_,{children:s("teacher.optionalField")}),e.jsx(d,{})]})}),e.jsx(a,{control:r.control,name:"description_es",render:({field:i})=>e.jsxs(c,{children:[e.jsx(l,{children:s("teacher.descriptionSpanish")}),e.jsx(o,{children:e.jsx(N,{placeholder:s("teacher.enterDescriptionSpanish"),className:"min-h-24",...i})}),e.jsx(_,{children:s("teacher.optionalField")}),e.jsx(d,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(a,{control:r.control,name:"language_id",render:({field:i})=>e.jsxs(c,{children:[e.jsx(l,{children:s("quiz.language")}),e.jsxs(w,{onValueChange:i.onChange,value:i.value,children:[e.jsx(o,{children:e.jsx(A,{children:e.jsx(B,{placeholder:s("teacher.selectLanguage")})})}),e.jsx(Q,{children:M?e.jsx(j,{value:"loading",disabled:!0,children:s("common.loading")}):b==null?void 0:b.map(t=>{var h;return e.jsx(j,{value:t.id.toString(),children:((h=t.name)==null?void 0:h.en)||t.name},t.id)})})]}),e.jsx(d,{})]})}),e.jsx(a,{control:r.control,name:"level",render:({field:i})=>e.jsxs(c,{children:[e.jsx(l,{children:s("quiz.level")}),e.jsxs(w,{onValueChange:i.onChange,value:i.value,children:[e.jsx(o,{children:e.jsx(A,{children:e.jsx(B,{placeholder:s("teacher.selectLevel")})})}),e.jsxs(Q,{children:[e.jsx(j,{value:"Beginner",children:s("levels.beginner")}),e.jsx(j,{value:"Intermediate",children:s("levels.intermediate")}),e.jsx(j,{value:"Advanced",children:s("levels.advanced")})]})]}),e.jsx(d,{})]})}),e.jsx(a,{control:r.control,name:"duration_minutes",render:({field:i})=>e.jsxs(c,{children:[e.jsxs(l,{children:[s("quiz.duration")," (",s("quiz.minutes"),")"]}),e.jsx(o,{children:e.jsx(p,{type:"number",min:"1",...i})}),e.jsx(d,{})]})}),e.jsx(a,{control:r.control,name:"passing_score",render:({field:i})=>e.jsxs(c,{children:[e.jsxs(l,{children:[s("quiz.passingScore")," (%)"]}),e.jsx(o,{children:e.jsx(p,{type:"number",min:"0",max:"100",...i})}),e.jsx(d,{})]})})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>u("/teacher/quizzes"),children:s("common.cancel")}),e.jsx(g,{type:"submit",disabled:z.isPending,children:z.isPending?s("common.loading"):s("common.save")})]})]})})})]})]})}):e.jsx(S,{children:e.jsx(v,{className:"p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("p",{className:"text-red-600",children:s("teacher.quizNotFound")}),e.jsx(g,{onClick:()=>u("/teacher/quizzes"),children:s("teacher.backToQuizzes")})]})})})};export{De as EditQuiz,De as default};
